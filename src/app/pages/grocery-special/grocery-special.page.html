<ion-header class="ion-no-border">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/home" color="dark" icon="arrow-back"></ion-back-button>
    </ion-buttons>
    <ion-title>{{title}}</ion-title>
    <ion-buttons slot="end">
      <ion-button color="dark" (click)="gotoSearch()">
        <ion-icon name="search-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="bg-light">

 @if (isLoading) {
   <div>
    <div style="margin: 16px; height: 180px; border-radius: 20px; overflow: hidden;">
      <ion-skeleton-text animated style="width: 100%; height: 100%; margin: 0;"></ion-skeleton-text>
    </div>

    <div style="display: flex; gap: 10px; padding: 0 16px; margin-bottom: 20px; overflow: hidden;">
      <ion-skeleton-text animated *ngFor="let i of [1,2,3,4]" style="width: 80px; height: 32px; border-radius: 20px; flex-shrink: 0;"></ion-skeleton-text>
    </div>

    <div class="product-grid px-3">
      <div *ngFor="let i of [1,2,3,4,5,6]" style="margin-bottom: 16px;">
         <ion-skeleton-text animated style="width: 100%; height: 150px; border-radius: 12px;"></ion-skeleton-text>
         <ion-skeleton-text animated style="width: 80%; height: 14px; margin-top: 10px; border-radius: 4px;"></ion-skeleton-text>
         <ion-skeleton-text animated style="width: 40%; height: 14px; margin-top: 5px; border-radius: 4px;"></ion-skeleton-text>
         <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 10px;">
           <ion-skeleton-text animated style="width: 50px; height: 20px; border-radius: 4px;"></ion-skeleton-text>
           <ion-skeleton-text animated style="width: 70px; height: 30px; border-radius: 6px;"></ion-skeleton-text>
         </div>
      </div>
    </div>
  </div>
 } @else if (isError) {
    <app-error 
      title="Failed to Load Products" 
      subtitle="Please check your internet connection and try again."
      buttonText="Retry"
      (retry)="getProductsByTerm()">
    </app-error>
 } @else {
  <div>
  <div class="hero-banner" [style.background]="categoryInfo.color">
    <div class="text-content">
      <h5>Fresh Picks</h5>
      <h2>{{categoryInfo.name}}</h2>
      <span class="offer-badge">{{categoryInfo.offerText}}</span>
    </div>
    <div class="img-content">
      <img [src]="categoryInfo.bannerImg" />
    </div>
  </div>

  <!-- <div class="filter-scroll">
    <div 
      class="chip" 
      *ngFor="let f of filters" 
      [class.active]="selectedFilter === f"
      (click)="setFilter(f)">
      {{f}}
    </div>
  </div> -->

  <div class="product-grid px-3">
    <app-product-card 
          *ngFor="let p of products"
          [product]="p"
          [qty]="getQty(p.id)"
          (increase)="increase($event)"
          (decrease)="decrease($event)"
          (itemClicked)="goToDetails($event)">
      </app-product-card>
  </div>

  <div style="height: 200px;"></div>
  </div>
 }

</ion-content>
