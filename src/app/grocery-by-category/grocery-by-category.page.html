<ion-header class="ion-no-border">
  <ion-toolbar>
    <div class="header-container">
      <h3>All Categories</h3>
      <div class="header-icons">
        <ion-icon name="search-outline" (click)="gotoSearch()"></ion-icon>
      </div>
    </div>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="bg-light">
  
  <div class="split-layout">
    
    <div class="sidebar">
      <div 
        class="cat-tab" 
        *ngFor="let cat of categories" 
        [class.active]="selectedCategory === cat.name"
        (click)="selectCategory(cat.name)">
        
        <div class="img-circle">
          <img [src]="cat.img" />
        </div>
        <span>{{cat.name}}</span>
        
        <div class="active-strip" *ngIf="selectedCategory === cat.name"></div>
      </div>
      <div style="height: 50px"></div>
    </div>

    <div class="main-content">
      
      <div class="content-header">
        <h4>{{selectedCategory | titlecase}}</h4>
        <small>{{products.length}} items</small>
      </div>

      <div class="product-grid">
        <div class="product-card" *ngFor="let p of products" (click)="goToDetails(p)">
          
          <div class="img-box">
            <img [src]="p.img" />
            <span class="offer-tag" *ngIf="p.discount > 0">{{p.discount}}% OFF</span>
          </div>

          <div class="details">
            <div class="name">{{p.name}}</div>
            <div class="weight">{{p.weight}}</div>
            
            <div class="price-action">
              <div class="price">
                <span class="curr">₹{{p.price}}</span>
                <span class="old" *ngIf="p.discount > 0">₹{{p.originalPrice}}</span>
              </div>
              <button class="add-btn" 
                    *ngIf="p.stock === 0" 
                    disabled
                    style="opacity: 0.7; background-color: #dcdcdc; color: #555; border: none;">
              OUT OF STOCK
            </button>

            <button class="add-btn" 
                    *ngIf="p.stock !== 0 && getQty(p.id) === 0" 
                    (click)="$event.stopPropagation(); increase(p.id)">
              ADD
            </button>

            <div class="qty-counter" *ngIf="p.stock !== 0 && getQty(p.id) > 0">
              <div class="minus" (click)="$event.stopPropagation(); decrease(p.id)">-</div>
              <div class="count">{{ getQty(p.id) }}</div>
              <div class="plus" (click)="$event.stopPropagation(); increase(p.id)">+</div>
            </div>
            </div>
          </div>

        </div>
      </div>
      
      <div style="height: 80px"></div>
    </div>

  </div>

</ion-content>